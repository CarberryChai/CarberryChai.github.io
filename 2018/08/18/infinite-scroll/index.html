<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>æ— é™æ»šåŠ¨ | Hexo</title>
    <meta name="author" content="John Doe" />
    <meta name="version" content="1.0.0" />
    <meta name="keywords" content="" />
    <meta name="description" content="æ— é™æ»šåŠ¨å¸¸å¸¸ç”¨äºç§»åŠ¨ç«¯ï¼Œæ˜¯pcç«¯åˆ†é¡µåœ¨ç§»åŠ¨ç«¯çš„å®ç°ã€‚è®²æ— é™æ»šåŠ¨ä¹‹å‰å…ˆäº†è§£ä¸€ä¸‹å…ƒç´ çš„å°ºå¯¸ï¼Œä¹‹å‰æˆ‘ç»å¸¸ææ··offsetHeightã€clientWidthã€scrollHeightç­‰ä¹‹é—´çš„å…³ç³»ã€‚
offsetHeight
1ã€å…ƒç´ åœ¨å‚ç›´æ–¹å‘ä¸Šå æ®çš„ç©ºé—´å¤§å°ï¼ˆçº¢å®ä¹¦ï¼‰2ã€ä¸€ç§å…ƒç´ CSSé«˜åº¦çš„è¡¡é‡æ ‡å‡†ï¼ŒåŒ…æ‹¬å…ƒç´ çš„è¾¹æ¡†ã€å†…è¾¹è·å’Œå…ƒç´ çš„æ°´å¹³æ»šåŠ¨    æ¡ï¼ˆå¦‚æœå­˜åœ¨ä¸”æ¸²æŸ“çš„è¯ï¼‰ï¼Œä¸åŒ…å«:beforeæˆ–:afterç­‰ä¼ªç±»å…ƒç´ çš„é«˜åº¦ã€‚

è¡¨ç¤ºå…ƒç´ åœ¨å±å¹•ä¸Šå æ®çš„å¯è§çš„ç©ºé—´ï¼ˆä¸ªäººè®¤ä¸ºæ˜¯å®¹å™¨çš„å¤§å°ï¼‰
clientWid" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <meta name="baidu-site-verification" content="F0CXvmUgA9" />

    
    
    <link rel="icon" href="/favicon.png">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <div class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <button id="open-panel" class="open-panel"><i class="icon-library"></i></button>

    <nav class="nav-inner">

        
        
        <li class="nav-item">
            <a class="nav-link" href="/">é¦–é¡µ</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/categories/front-end">å‰ç«¯</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/back-end">åç«¯</a>
        </li>
        
        
        
        <li class="nav-item nav-item-tag">
            <a id="nav-tag" class="nav-link" href="#">æ ‡ç­¾</a>
            <div id="nav-tags" class="nav-tag-wrap">
                <i class="nav-tag-arrow"></i>
                
  <div class="widget-wrap">
    <h3 class="widget-title">
        <i class="icon-tag vm"></i>
        <span class="vm">Tags</span>
    </h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
    </div>
  </div>


            </div>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/archives">å½’æ¡£</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/atom.xml">è®¢é˜…</a>
        </li>
        
        
        
        <li class="nav-item">
            <a class="nav-link" href="/about">å…³äº</a>
        </li>
        
        
        

    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#offsetHeight"><span class="toc-number">1.</span> <span class="toc-text">offsetHeight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#clientWidth"><span class="toc-number">2.</span> <span class="toc-text">clientWidth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scrollHeight"><span class="toc-number">3.</span> <span class="toc-text">scrollHeight</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ— é™æ»šåŠ¨"><span class="toc-number">4.</span> <span class="toc-text">æ— é™æ»šåŠ¨</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            æ— é™æ»šåŠ¨
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="/2018/08/18/infinite-scroll/">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2018-08-18T01:59:52.000Z" itemprop="datePublished">2018-08-18</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/javascript/">javascript</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>æ— é™æ»šåŠ¨å¸¸å¸¸ç”¨äºç§»åŠ¨ç«¯ï¼Œæ˜¯pcç«¯åˆ†é¡µåœ¨ç§»åŠ¨ç«¯çš„å®ç°ã€‚<br>è®²æ— é™æ»šåŠ¨ä¹‹å‰å…ˆäº†è§£ä¸€ä¸‹å…ƒç´ çš„å°ºå¯¸ï¼Œä¹‹å‰æˆ‘ç»å¸¸ææ··<code>offsetHeight</code>ã€<code>clientWidth</code>ã€<code>scrollHeight</code>ç­‰ä¹‹é—´çš„å…³ç³»ã€‚</p>
<h3 id="offsetHeight"><a href="#offsetHeight" class="headerlink" title="offsetHeight"></a>offsetHeight</h3><blockquote>
<p>1ã€å…ƒç´ åœ¨å‚ç›´æ–¹å‘ä¸Šå æ®çš„ç©ºé—´å¤§å°ï¼ˆçº¢å®ä¹¦ï¼‰<br>2ã€ä¸€ç§å…ƒç´ CSSé«˜åº¦çš„è¡¡é‡æ ‡å‡†ï¼ŒåŒ…æ‹¬å…ƒç´ çš„è¾¹æ¡†ã€å†…è¾¹è·å’Œå…ƒç´ çš„æ°´å¹³æ»šåŠ¨    æ¡ï¼ˆå¦‚æœå­˜åœ¨ä¸”æ¸²æŸ“çš„è¯ï¼‰ï¼Œä¸åŒ…å«:beforeæˆ–:afterç­‰ä¼ªç±»å…ƒç´ çš„é«˜åº¦ã€‚</p>
</blockquote>
<p>è¡¨ç¤ºå…ƒç´ åœ¨å±å¹•ä¸Šå æ®çš„<strong>å¯è§çš„ç©ºé—´</strong>ï¼ˆä¸ªäººè®¤ä¸ºæ˜¯å®¹å™¨çš„å¤§å°ï¼‰<br><img src="/2018/08/18/infinite-scroll/1.png" title="åç§»é‡"></p>
<h3 id="clientWidth"><a href="#clientWidth" class="headerlink" title="clientWidth"></a>clientWidth</h3><blockquote>
<p>1ã€å…ƒç´ å†…å®¹åŠå…¶å†…è¾¹è·æ‰€å æ®çš„ç©ºé—´å¤§å°<br>2ã€è¡¨ç¤ºå…ƒç´ çš„å†…éƒ¨å®½åº¦</p>
</blockquote>
<p>è¡¨ç¤ºå…ƒç´ çš„å†…éƒ¨å¤§å°ï¼Œè€Œ<code>offsetHeight</code>æŒ‡å¤–éƒ¨å®¹å™¨å¤§å°<br><img src="/2018/08/18/infinite-scroll/2.jpg" title="å®¢æˆ·å»å¤§å°"></p>
<h3 id="scrollHeight"><a href="#scrollHeight" class="headerlink" title="scrollHeight"></a>scrollHeight</h3><blockquote>
<p>1ã€åŒ…å«æ»šåŠ¨å†…å®¹çš„å…ƒç´ å¤§å°<br>2ã€ä¸€ä¸ªå…ƒç´ å†…å®¹é«˜åº¦çš„åº¦é‡ï¼ŒåŒ…æ‹¬ç”±äºæº¢å‡ºå¯¼è‡´çš„è§†å›¾ä¸­ä¸å¯è§å†…å®¹ã€‚</p>
</blockquote>
<p>ä¸€èˆ¬æŒ‡çš„æ˜¯æœ‰æ»šåŠ¨æ¡çš„ï¼ˆ<code>overflow:scroll</code>ï¼‰çš„å…ƒç´ å¤§å°ï¼Œå¦‚æœå…ƒç´ å†…å®¹çš„å¤§å°å°äºç­‰äºå®¹å™¨çš„å¤§å°ï¼Œ<code>scrollHeight</code>ç­‰äº<code>clientHeight</code><br><img src="/2018/08/18/infinite-scroll/3.jpg" title="æ»šåŠ¨å¤§å°"></p>
<h3 id="æ— é™æ»šåŠ¨"><a href="#æ— é™æ»šåŠ¨" class="headerlink" title="æ— é™æ»šåŠ¨"></a>æ— é™æ»šåŠ¨</h3><p>ä»¥<code>vue</code>æ¡†æ¶ä¸ºä¾‹è®²è§£æ— é™æ»šåŠ¨, å®‰è£…vue-cliè„šæ‰‹æ¶<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i -g @vue/cli</span><br><span class="line">vue create scroll-demo</span><br><span class="line">npm serve</span><br></pre></td></tr></table></figure></p>
<p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š<br><img src="/2018/08/18/infinite-scroll/carbon.png" title="æºç "><br>æ ¸å¿ƒä»£ç ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, () =&gt; &#123;</span><br><span class="line">   <span class="keyword">const</span> el = <span class="built_in">document</span>.documentElement</span><br><span class="line">   <span class="keyword">if</span> (el.scrollTop + <span class="built_in">window</span>.innerHeight &gt;= el.scrollHeight * <span class="number">0.8</span>) &#123;</span><br><span class="line">       <span class="keyword">this</span>.fetchList()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure></p>
<p>å…¶å®å°±æ˜¯å½“æ»šåŠ¨è·ç¦»<code>scrollTop</code> + æ•´ä¸ªå±å¹•çš„å¯æ˜¯é«˜åº¦å¤§äºç­‰äºæ ¹å…ƒç´ çš„æ»šåŠ¨é«˜åº¦ï¼ˆå…¶å®å°±æ˜¯æ•´ä¸ªç½‘é¡µçš„é«˜åº¦ï¼‰ï¼Œå°±å»å‘é€Ajaxè¯·æ±‚ï¼Œåœ¨è¯·æ±‚è¿˜æœªå®Œæˆä¹‹æ—¶ï¼Œå¦‚æœè¿˜æœ‰æ»šåŠ¨è¡Œä¸ºï¼Œæ­¤æ—¶ä¹Ÿæ»¡è¶³<code>el.scrollTop + window.innerHeight &gt;= el.scrollHeight * 0.8</code>å°±ä¼šä¸€ç›´è§¦å‘Ajaxè¯·æ±‚ï¼Œæœ‰æ—¶çŸ­æ—¶é—´å†…ä¼šè§¦å‘å‡ åä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦é˜»æ­¢æŒç»­çš„è¯·æ±‚ã€‚<br>å¾ˆç®€å•ï¼ŒåŠ ä¸ªå¼€å…³ï¼Œå…¶å®è·Ÿé—¨ä¸ŠåŠ ä¸ªé”ä¸€æ ·ï¼Œæˆ‘è¿›æ¥äº†å°±æŠŠé—¨é”ä¸Šï¼Œè¿™æ ·å…¶ä»–äººè¿›ä¸æ¥ï¼Œç­‰æˆ‘å‡ºæ¥äº†å†æŠŠé—¨æ‰“å¼€ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åŠ äº†<code>loading</code>ï¼Œå½“è¯·æ±‚è¿˜æœªå®Œæˆæ—¶ï¼Œæˆ‘ä»¬è®¾ç½®<code>loading = true</code>ï¼Œæ˜¾ç¤ºâ€˜è¯·ç¨åâ€¦â€¦â€™çš„æç¤ºè¯­ï¼Œåœ¨è¿™æ®µæ—¶é—´è¿˜æœ‰è¯·æ±‚è¿‡æ¥ï¼Œæˆ‘ä»¬å°±ä»€ä¹ˆä¹Ÿä¸åšè¿”å›ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>.loading || <span class="keyword">this</span>.endFlag)&#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ ·å°±è§£å†³äº†æ»¡è¶³<code>el.scrollTop + window.innerHeight &gt;= el.scrollHeight * 0.8</code>åªä¼šå‘é€ä¸€æ¬¡è¯·æ±‚ã€‚<br>æœ€åï¼Œç»“æŸçš„æ—¶å€™ï¼Œæœ€åä¸€é¡µï¼Œç›¸åŒçš„æƒ…å†µï¼Œå†åŠ ä¸ªå¼€å…³<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">Math</span>.ceil(data.count / <span class="keyword">this</span>.pageSize) === <span class="keyword">this</span>.cpage) &#123;</span><br><span class="line">         <span class="keyword">this</span>.endFlag = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ€»æ•°é‡é™¤ä»¥æ¯é¡µè¯·æ±‚çš„æ•°é‡ç­‰äºå½“å‰é¡µï¼Œå°±è¡¨ç¤ºæ˜¯æœ€åä¸€é¡µäº†ï¼Œæ­¤æ—¶æˆ‘ä»¬<code>this.endFlag = true</code>é˜»æ­¢åç»­çš„è¯·æ±‚ï¼ŒåŒæ—¶å‘Šè¯‰ç”¨æˆ·â€˜å·²ç»åˆ°åº•å•¦~â€™<br>æœ€åï¼Œæ— é™æ»šåŠ¨æ˜¯æ¯ä¸ªå‰ç«¯ç«¥é‹éƒ½å¿…é¡»æŒæ¡çš„ï¼Œå¾ˆå¸¸ç”¨ï¼Œè¿™ç¯‡ç®—æ˜¯ä¸ªäººçš„ä¸€ç‚¹å°å°æ€»ç»“å§!ğŸ˜ğŸ˜ğŸ˜</p>

        
    </section>
</article>



</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>
</footer>


    </div>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    
    <script type="text/javascript" src="/js/scrollspy.min.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var nodes = {
                nav: $('#nav'),
                aside: $('#aside'),
                navTags: $('#nav-tags')
            };

            $('#open-panel, #aside-mask').on('click', function() {
                nodes.aside.toggleClass('panel-show');
            });
            $('#nav-tag').on('click', function(event) {
                event.preventDefault();console.log(nodes.navTags.attr('class'))
                nodes.navTags.toggleClass('tag-show');console.log(nodes.navTags.attr('class'))
            })/*.hover(function() {
                nodes.navTags.addClass('tag-show');
            }, function() {
                nodes.navTags.removeClass('tag-show');
            });*/

            
            $(document.body).scrollspy({target: '#aside-inner'});
            
        });
    </script>

</body>
</html>
